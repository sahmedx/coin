<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Investment Analysis: Coinbase (COIN)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
<style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F8F7F4;
            color: #2D3748;
        }
        .nav-active {
            color: #0052FF;
            border-bottom-color: #0052FF;
        }
        .nav-link {
            transition: all 0.2s ease-in-out;
            border-bottom: 2px solid transparent;
        }
        .nav-link:hover {
            color: #0052FF;
            border-bottom-color: #A3BFFA;
        }
        .card {
            background-color: #FFFFFF;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -2px rgb(0 0 0 / 0.1);
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 320px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }
        .btn {
            transition: all 0.2s ease-in-out;
        }
        .btn-active {
            background-color: #0052FF !important;
            color: #FFFFFF !important;
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-in-out;
        }
    </style>
</head>
<body class="antialiased">

    <header class="bg-white/80 backdrop-blur-md sticky top-0 z-40 shadow-sm">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex-shrink-0">
                    <h1 class="text-xl md:text-2xl font-bold text-gray-800">COIN Investment Analysis</h1>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="#summary" class="nav-link px-3 py-2 text-sm font-medium text-gray-600">Summary</a>
                        <a href="#financials" class="nav-link px-3 py-2 text-sm font-medium text-gray-600">Financials</a>
                        <a href="#thesis" class="nav-link px-3 py-2 text-sm font-medium text-gray-600">Bull vs. Bear</a>
                        <a href="#competition" class="nav-link px-3 py-2 text-sm font-medium text-gray-600">Market</a>
                        <a href="#catalysts" class="nav-link px-3 py-2 text-sm font-medium text-gray-600">Catalysts</a>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
        
        <section class="text-center mb-16">
            <h2 class="text-3xl sm:text-4xl lg:text-5xl font-extrabold text-gray-900 tracking-tight">
                Coinbase, Inc. (COIN) Equity Research
            </h2>
            <p class="mt-4 max-w-2xl mx-auto text-lg text-gray-500">
                Positioning to be the "AWS of Crypto" with significant macro tailwinds.
            </p>
            <div class="mt-8 grid grid-cols-1 md:grid-cols-3 gap-6 max-w-4xl mx-auto">
                <div class="bg-blue-600/10 p-6 rounded-xl text-center">
                    <p class="text-sm font-medium text-blue-800 uppercase tracking-wider">Recommendation</p>
                    <p class="text-3xl font-bold text-blue-900 mt-1">Overweight</p>
                </div>
                <div class="bg-green-600/10 p-6 rounded-xl text-center">
                    <p class="text-sm font-medium text-green-800 uppercase tracking-wider">Confidence</p>
                    <p class="text-3xl font-bold text-green-900 mt-1">High</p>
                </div>
                <div class="bg-yellow-600/10 p-6 rounded-xl text-center">
                    <p class="text-sm font-medium text-yellow-800 uppercase tracking-wider">Timeframe</p>
                    <p class="text-3xl font-bold text-yellow-900 mt-1">18-36 Months</p>
                </div>
            </div>
        </section>

        <section id="summary" class="mb-16 scroll-mt-20">
            <h3 class="text-2xl font-bold text-gray-800 mb-2">Investment Summary</h3>
            <p class="text-gray-600 mb-8 max-w-3xl">We are initiating a buy on Coinbase (COIN), centered on its strategic pivot to becoming the indispensable infrastructural backbone of the digital asset economy. The core thesis is that Coinbase's value extends far beyond a simple crypto exchange, warranting a premium valuation based on its high-margin, recurring revenue streams.
            </p>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="card p-6">
                    <h4 class="font-bold text-lg mb-2 text-gray-900">The "AWS of Crypto"</h4>
                    <p class="text-gray-600 text-sm">Coinbase is successfully building a suite of essential services—custody, staking, Layer 2 scaling (Base), and developer tools—creating a high-margin, sticky ecosystem that powers the crypto economy.</p>
                </div>
                <div class="card p-6">
                    <h4 class="font-bold text-lg mb-2 text-gray-900">De-Risking Revenue</h4>
                    <p class="text-gray-600 text-sm">The rapid growth of Subscription & Services revenue diversifies income away from volatile transaction fees, providing a more predictable and stable financial foundation that merits a higher valuation multiple.</p>
                </div>
                <div class="card p-6">
                    <h4 class="font-bold text-lg mb-2 text-gray-900">Institutional On-Ramp</h4>
                    <p class="text-gray-600 text-sm">As the chosen custodian for the majority of spot Bitcoin ETFs, Coinbase has solidified its role as the trusted gateway for institutional capital flowing into the digital asset class.</p>
                </div>
                <div class="card p-6">
                    <h4 class="font-bold text-lg mb-2 text-gray-900">Regulatory Headwind Shift</h4>
                    <p class="text-gray-600 text-sm">The dismissal of the SEC lawsuit in early 2025 has removed a major overhang. The focus now shifts to proactive regulation, where Coinbase's scale and compliance focus position it as a key partner in shaping future rules.</p>
                </div>
                <div class="card p-6">
                    <h4 class="font-bold text-lg mb-2 text-gray-900">Ecosystem Flywheel</h4>
                    <p class="text-gray-600 text-sm">The Base Layer 2 network is a masterstroke, attracting developers and users, driving transaction volume, and creating a captive economy where Coinbase provides the core services, creating a powerful network effect.</p>
                </div>
                 <div class="card p-6 flex flex-col justify-center">
                    <p class="text-gray-700 font-semibold">The investment case is a bet on the crypto economy's growth, with Coinbase positioned as the primary "picks and shovels" provider, capturing value across the entire ecosystem.</p>
                </div>
            </div>
        </section>

        <section id="financials" class="mb-16 scroll-mt-20">
            <h3 class="text-2xl font-bold text-gray-800 mb-2">Financial Deep Dive: The Thesis in Numbers</h3>
            <p class="text-gray-600 mb-8 max-w-3xl">Explore Coinbase's key financial metrics. This interactive chart visualizes the core investment thesis, from top-line revenue trends to bottom-line profitability and the components of its key growth engine. Use the buttons to switch between different views.</p>
            <div class="bg-white p-6 rounded-xl shadow-lg">
                <div class="flex justify-center mb-6">
                    <div class="inline-flex rounded-md shadow-sm flex-wrap justify-center" role="group">
                        <button type="button" id="btn-revenue" class="btn-toggle btn btn-active rounded-l-lg border border-gray-200 bg-white px-4 py-2 text-sm font-medium text-gray-900 hover:bg-gray-100 focus:z-10 focus:ring-2 focus:ring-blue-700">Revenue ($M)</button>
                        <button type="button" id="btn-mix" class="btn-toggle btn border-t border-b border-l border-gray-200 bg-white px-4 py-2 text-sm font-medium text-gray-900 hover:bg-gray-100 focus:z-10 focus:ring-2 focus:ring-blue-700">Revenue Mix (%)</button>
                        <button type="button" id="btn-servicesbreakdown" class="btn-toggle btn border-t border-b border-gray-200 bg-white px-4 py-2 text-sm font-medium text-gray-900 hover:bg-gray-100 focus:z-10 focus:ring-2 focus:ring-blue-700">S&S Breakdown</button>
                        <button type="button" id="btn-netincome" class="btn-toggle btn border-t border-b border-l border-gray-200 bg-white px-4 py-2 text-sm font-medium text-gray-900 hover:bg-gray-100 focus:z-10 focus:ring-2 focus:ring-blue-700">Net Income</button>
                        <button type="button" id="btn-adjustedebitda" class="btn-toggle btn rounded-r-md border border-gray-200 bg-white px-4 py-2 text-sm font-medium text-gray-900 hover:bg-gray-100 focus:z-10 focus:ring-2 focus:ring-blue-700">Adj. EBITDA</button>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="financialsChart"></canvas>
                </div>
                 <div class="mt-8 grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
                    <div>
                        <p class="text-sm text-gray-500">2024 Revenue</p>
                        <p class="text-2xl font-bold text-gray-800">$6.6B</p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-500">2024 Net Income</p>
                        <p class="text-2xl font-bold text-gray-800">$2.6B</p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-500">Assets on Platform (2024)</p>
                        <p class="text-2xl font-bold text-gray-800">$220B+</p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-500">Cash Position (Q4'24)</p>
                        <p class="text-2xl font-bold text-gray-800">$9.3B</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="thesis" class="mb-16 scroll-mt-20">
            <h3 class="text-2xl font-bold text-gray-800 mb-2">The Thesis: Bull vs. Bear</h3>
            <p class="text-gray-600 mb-8 max-w-3xl">The investment case for Coinbase hinges on its transformation into a diversified crypto-technology provider against the persistent risks of market volatility and regulation. This section breaks down the core arguments. Click each argument to expand and explore the details.</p>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <div>
                    <h4 class="text-xl font-semibold text-green-700 mb-4 text-center">Bull Case: The "AWS of Crypto"</h4>
                    <div class="space-y-4">
                        <div class="card accordion-item">
                            <button class="accordion-header w-full p-4 text-left font-semibold flex justify-between items-center">Infrastructure & Services Growth <span>+</span></button>
                            <div class="accordion-content px-4 pb-4">
                                <p class="text-gray-600 text-sm">Subscription & Services revenue hit nearly $700M in Q1 2025. This isn't just a side business; it's the future. It includes high-margin staking rewards, custody fees from ETFs, stablecoin revenue (USDC), and developer services via Coinbase Cloud. This creates a sticky, resilient, high-growth business model.</p>
                            </div>
                        </div>
                        <div class="card accordion-item">
                            <button class="accordion-header w-full p-4 text-left font-semibold flex justify-between items-center">The Base Layer 2 Flywheel <span>+</span></button>
                            <div class="accordion-content px-4 pb-4">
                                <p class="text-gray-600 text-sm">Base is a strategic masterstroke. It has rapidly become a leading Ethereum Layer 2 solution with over $3.6B in Total Value Locked (TVL). By controlling the chain, Coinbase fosters a captive ecosystem, driving transaction flow, attracting developers, and creating demand for its other services in a powerful, self-reinforcing loop.</p>
                            </div>
                        </div>
                        <div class="card accordion-item">
                            <button class="accordion-header w-full p-4 text-left font-semibold flex justify-between items-center">Trusted Institutional Gateway<span>+</span></button>
                            <div class="accordion-content px-4 pb-4">
                                <p class="text-gray-600 text-sm">Coinbase Prime is the dominant platform for institutions, serving as the custodian for 8 of the 11 major spot Bitcoin ETFs. This provides a steady stream of custody fees and cements Coinbase as the most trusted, secure, and regulated on-ramp for the massive wave of institutional capital entering the crypto space.</p>
                            </div>
                        </div>
                    </div>
                </div>
                 <div>
                    <h4 class="text-xl font-semibold text-red-700 mb-4 text-center">Bear Case: Persistent Risks</h4>
                    <div class="space-y-4">
                        <div class="card accordion-item">
                             <button class="accordion-header w-full p-4 text-left font-semibold flex justify-between items-center">Transaction Revenue Volatility <span>+</span></button>
                            <div class="accordion-content px-4 pb-4">
                                <p class="text-gray-600 text-sm">Despite diversification, transaction fees still account for the majority of revenue. A prolonged "crypto winter" or a sharp decline in trading volumes would significantly impact top-line results and profitability, regardless of how well the services division performs in the short term.</p>
                            </div>
                        </div>
                        <div class="card accordion-item">
                            <button class="accordion-header w-full p-4 text-left font-semibold flex justify-between items-center">Future Regulatory Uncertainty <span>+</span></button>
                            <div class="accordion-content px-4 pb-4">
                                <p class="text-gray-600 text-sm">While the 2023 SEC case was dismissed, the regulatory landscape for crypto remains far from settled. Future legislation or enforcement actions around staking, stablecoins, or asset classifications could create significant headwinds, impose costly compliance burdens, or render certain business lines untenable.</p>
                            </div>
                        </div>
                         <div class="card accordion-item">
                            <button class="accordion-header w-full p-4 text-left font-semibold flex justify-between items-center">Consistent Insider Selling <span>+</span></button>
                            <div class="accordion-content px-4 pb-4">
                                <p class="text-gray-600 text-sm">Data from 2024 and 2025 shows persistent and significant stock sales by top executives, including the CEO and CFO. While some sales are pre-scheduled, the sheer volume of selling compared to zero open-market buys can be interpreted as a lack of conviction in near-term upside from current price levels.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="competition" class="mb-16 scroll-mt-20">
             <h3 class="text-2xl font-bold text-gray-800 mb-2">Market and Competitive Landscape</h3>
             <p class="text-gray-600 mb-8 max-w-3xl">Coinbase's valuation reflects its unique position in the market. It's not just a crypto exchange; it's a technology platform. The chart below compares its Price-to-Sales (P/S) ratio to a retail-focused competitor and traditional financial exchanges, illustrating the premium investors assign to its diversified, high-growth model.</p>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <div class="bg-white p-6 rounded-xl shadow-lg">
                    <h4 class="font-semibold text-lg mb-4 text-center">Valuation vs. Peers (Price-to-Sales Ratio TTM)</h4>
                    <div class="chart-container h-80 md:h-96">
                        <canvas id="valuationChart"></canvas>
                    </div>
                </div>
                <div class="space-y-4">
                    <div class="card p-6">
                        <h4 class="font-bold text-lg mb-2 text-gray-900">vs. Robinhood (HOOD)</h4>
                        <p class="text-gray-600 text-sm">Robinhood is a key competitor for retail users but lacks Coinbase's deep institutional infrastructure and burgeoning services division. Its lower valuation reflects a business model more reliant on payment for order flow and less diversified crypto operations.</p>
                    </div>
                    <div class="card p-6">
                        <h4 class="font-bold text-lg mb-2 text-gray-900">vs. Decentralized Exchanges (DEXs)</h4>
                        <p class="text-gray-600 text-sm">DEXs like Uniswap offer a non-custodial alternative for trading. While a long-term threat, they currently lack the user-friendliness, fiat on-ramps, and institutional trust that make Coinbase the dominant entry point for most users and capital.</p>
                    </div>
                    <div class="card p-6">
                        <h4 class="font-bold text-lg mb-2 text-gray-900">vs. Traditional Exchanges (CME/ICE)</h4>
                        <p class="text-gray-600 text-sm">Legacy exchanges are entering the crypto derivatives market but do not offer the core spot trading, custody, or on-chain services that define the crypto-native economy. Coinbase's valuation premium reflects its higher growth potential and central role in a disruptive new asset class.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="catalysts" class="scroll-mt-20">
            <h3 class="text-2xl font-bold text-gray-800 mb-2">Catalyst Watchlist</h3>
            <p class="text-gray-600 mb-8 max-w-3xl">Coinbase's stock performance will be driven by both cyclical market trends and secular growth in its services division. This timeline highlights the key milestones to watch.</p>
            <div class="relative">
                <div class="border-l-2 border-gray-300 absolute h-full top-0 left-4"></div>
                <div class="space-y-8">
                    <div class="relative pl-12">
                         <div class="absolute w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center top-0 -left-4 text-white font-bold">1</div>
                        <h4 class="font-bold text-lg">Short-Term Drivers (0-12 Months)</h4>
                        <ul class="list-disc list-inside text-gray-600 text-sm mt-2 space-y-1">
                            <li>Quarterly Subscription & Services Growth: Continued double-digit growth is key to the thesis.</li>
                            <li>Base Ecosystem Metrics: Growth in TVL, dApps, and daily active users on the Base network.</li>
                            <li>Institutional Product Adoption: Announcements of new clients for Coinbase Prime and Custody.</li>
                            <li>Stablecoin Market Cap Growth: Expansion of USDC market cap, driving revenue.</li>
                             <li>Clarity on US Crypto Regulation: Any progress on market structure bills.</li>
                        </ul>
                    </div>
                    <div class="relative pl-12">
                        <div class="absolute w-8 h-8 bg-gray-800 rounded-full flex items-center justify-center top-0 -left-4 text-white font-bold">2</div>
                        <h4 class="font-bold text-lg">Long-Term Drivers (12-36+ Months)</h4>
                        <ul class="list-disc list-inside text-gray-600 text-sm mt-2 space-y-1">
                            <li>Approval of Ethereum ETFs: Further solidifying the role of custody and staking services.</li>
                            <li>International Exchange Growth: Gaining market share in derivatives outside the US.</li>
                            <li>Coinbase One Adoption: Growth of the retail subscription bundle, increasing recurring revenue.</li>
                            <li>Monetization of Wallet: Evolving the self-custody wallet into a revenue-generating web3 browser.</li>
                            <li>Tokenization of Real-World Assets: Positioning Coinbase as the core infrastructure for a multi-trillion dollar opportunity.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="bg-gray-800 mt-16">
        <div class="container mx-auto py-4 px-5 text-center">
            <p class="text-gray-400 text-sm">
                This interactive report is an interpretation of publicly available financial data and news. Data is sourced for illustrative purposes. Not financial advice.
            </p>
        </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Data for the financial charts
            const financialData = {
                labels: ['Q1 2024', 'Q2 2024', 'Q3 2024', 'Q4 2024', 'Q1 2025'],
                revenue: {
                    transaction: [1077, 781, 573, 1556, 1300],
                    subscriptionAndServices: [511, 569, 579, 641, 698],
                },
                servicesBreakdown: {
                    labels: ['Stablecoin Revenue', 'Blockchain Rewards', 'Custodial Fees', 'Other'],
                    // Data structured by component for easy use in stacked charts
                    components: {
                        stablecoin: [197, 215, 225, 283, 314],
                        rewards: [151, 165, 170, 195, 210],
                        custody: [111, 130, 134, 103, 120],
                        other: [52, 59, 50, 60, 54]
                    },
                    colors: ['#0052FF', '#4C8DFF', '#89B3FF', '#C5D9FF']
                },
                netIncome: [1176, 36, 75, 1291, 66],
                adjustedEbitda: [1014, 596, 449, 1289, 930]
            };

            const valuationData = {
                labels: ['Coinbase (COIN)', 'Robinhood (HOOD)', 'CME Group (CME)', 'Intercontinental (ICE)'],
                psRatios: [13.4, 6.1, 16.2, 11.1], 
            };

            let financialChart;
            
            const financialsChartCtx = document.getElementById('financialsChart').getContext('2d');
            const valuationChartCtx = document.getElementById('valuationChart').getContext('2d');

            function getBarColors(data) {
                const positiveColor = 'rgba(0, 82, 255, 0.7)';
                const positiveBorder = 'rgba(0, 82, 255, 1)';
                const negativeColor = 'rgba(239, 68, 68, 0.7)';
                const negativeBorder = 'rgba(239, 68, 68, 1)';
                return {
                    background: data.map(value => value >= 0 ? positiveColor : negativeColor),
                    border: data.map(value => value >= 0 ? positiveBorder : negativeBorder)
                };
            }

            function createFinancialChart(dataType) {
                if (financialChart) {
                    financialChart.destroy();
                }

                let chartConfig = {
                    type: 'bar',
                    data: { labels: financialData.labels },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            title: { display: true, font: { size: 16 } },
                            tooltip: { mode: 'index', intersect: false }
                        }
                    }
                };

                switch (dataType) {
                    case 'revenue':
                        chartConfig.options.plugins.title.text = 'Revenue by Segment ($M)';
                        chartConfig.options.plugins.tooltip.callbacks = {
                            label: (context) => `$${new Intl.NumberFormat('en-US').format(context.parsed.y)}M`
                        };
                        chartConfig.data.datasets = [{
                            label: 'Transaction Revenue',
                            data: financialData.revenue.transaction,
                            backgroundColor: 'rgba(107, 114, 128, 0.7)',
                        }, {
                            label: 'Subscription & Services',
                            data: financialData.revenue.subscriptionAndServices,
                            backgroundColor: 'rgba(0, 82, 255, 0.7)',
                        }];
                        chartConfig.options.scales = { 
                            x: { stacked: true }, 
                            y: { stacked: true, title: { display: true, text: 'Revenue ($M)' } } 
                        };
                        break;
                    case 'mix':
                        chartConfig.options.plugins.title.text = 'Revenue Mix by Segment (%)';
                        chartConfig.options.plugins.tooltip.callbacks = { label: (context) => `${context.parsed.y}%` };
                        const totals = financialData.revenue.transaction.map((t, i) => t + financialData.revenue.subscriptionAndServices[i]);
                        const transactionMix = financialData.revenue.transaction.map((t, i) => parseFloat((t / totals[i] * 100).toFixed(1)));
                        const servicesMix = financialData.revenue.subscriptionAndServices.map((s, i) => parseFloat((s / totals[i] * 100).toFixed(1)));
                        chartConfig.data.datasets = [{
                            label: 'Transaction Revenue',
                            data: transactionMix,
                            backgroundColor: 'rgba(107, 114, 128, 0.7)',
                        }, {
                            label: 'Subscription & Services',
                            data: servicesMix,
                            backgroundColor: 'rgba(0, 82, 255, 0.7)',
                        }];
                        chartConfig.options.scales = {
                            x: { stacked: true },
                            y: { stacked: true, max: 100, title: { display: true, text: 'Percentage of Revenue (%)' }, ticks: { callback: (value) => `${value}%` } }
                        };
                        break;
                    case 'servicesbreakdown':
                        chartConfig.options.plugins.title.text = 'Subscription & Services Breakdown ($M)';
                        chartConfig.options.plugins.tooltip.callbacks = {
                            label: (context) => `${context.dataset.label}: $${new Intl.NumberFormat('en-US').format(context.parsed.y)}M`
                        };
                        chartConfig.data.datasets = [{
                            label: 'Stablecoin Revenue',
                            data: financialData.servicesBreakdown.components.stablecoin,
                            backgroundColor: financialData.servicesBreakdown.colors[0],
                        }, {
                            label: 'Blockchain Rewards',
                            data: financialData.servicesBreakdown.components.rewards,
                            backgroundColor: financialData.servicesBreakdown.colors[1],
                        }, {
                            label: 'Custodial Fees',
                            data: financialData.servicesBreakdown.components.custody,
                            backgroundColor: financialData.servicesBreakdown.colors[2],
                        }, {
                            label: 'Other',
                            data: financialData.servicesBreakdown.components.other,
                            backgroundColor: financialData.servicesBreakdown.colors[3],
                        }];
                        chartConfig.options.scales = { 
                            x: { stacked: true }, 
                            y: { stacked: true, title: { display: true, text: 'Revenue ($M)' } } 
                        };
                        break;
                    case 'netincome':
                        chartConfig.options.plugins.title.text = 'Quarterly Net Income ($M)';
                        chartConfig.options.plugins.legend = { display: false };
                        const netIncomeColors = getBarColors(financialData.netIncome);
                        chartConfig.data.datasets = [{
                            label: 'Net Income ($M)',
                            data: financialData.netIncome,
                            backgroundColor: netIncomeColors.background,
                            borderColor: netIncomeColors.border,
                            borderWidth: 1
                        }];
                        chartConfig.options.scales = { y: { title: { display: true, text: 'Net Income ($M)' } } };
                        break;
                    case 'adjustedebitda':
                        chartConfig.options.plugins.title.text = 'Quarterly Adjusted EBITDA ($M)';
                        chartConfig.options.plugins.legend = { display: false };
                        const ebitdaColors = getBarColors(financialData.adjustedEbitda);
                        chartConfig.data.datasets = [{
                            label: 'Adjusted EBITDA ($M)',
                            data: financialData.adjustedEbitda,
                            backgroundColor: ebitdaColors.background,
                            borderColor: ebitdaColors.border,
                            borderWidth: 1
                        }];
                        chartConfig.options.scales = { y: { title: { display: true, text: 'Adjusted EBITDA ($M)' } } };
                        break;
                }

                financialChart = new Chart(financialsChartCtx, chartConfig);
            }
            
            // Valuation Chart
            new Chart(valuationChartCtx, {
                type: 'bar',
                data: {
                    labels: valuationData.labels,
                    datasets: [{
                        label: 'Price-to-Sales Ratio (TTM)',
                        data: valuationData.psRatios,
                        backgroundColor: [
                            'rgba(0, 82, 255, 0.7)',
                            'rgba(107, 114, 128, 0.7)',
                            'rgba(107, 114, 128, 0.7)',
                            'rgba(107, 114, 128, 0.7)',
                        ],
                        borderColor: [
                           'rgba(0, 82, 255, 1)',
                           'rgba(107, 114, 128, 1)',
                           'rgba(107, 114, 128, 1)',
                           'rgba(107, 114, 128, 1)',
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    plugins: {
                        legend: { display: false },
                        title: { display: false },
                        tooltip: {
                             callbacks: {
                                label: function(context) {
                                    let value = context.parsed.x;
                                    return value ? value.toFixed(1) + 'x' : 'N/A';
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Price-to-Sales (P/S) Ratio'
                            }
                        }
                    }
                }
            });

            // Event listener for the main toggle buttons
            document.querySelectorAll('.btn-toggle').forEach(button => {
                button.addEventListener('click', function() {
                    document.querySelectorAll('.btn-toggle').forEach(btn => btn.classList.remove('btn-active'));
                    this.classList.add('btn-active');
                    const dataType = this.id.replace('btn-', '');
                    createFinancialChart(dataType);
                });
            });
            
            const accordionItems = document.querySelectorAll('.accordion-item');
            accordionItems.forEach(item => {
                const header = item.querySelector('.accordion-header');
                const content = item.querySelector('.accordion-content');
                const icon = header.querySelector('span');
                header.addEventListener('click', () => {
                    const isOpened = content.style.maxHeight && content.style.maxHeight !== '0px';
                    if (isOpened) {
                        content.style.maxHeight = '0px';
                        icon.textContent = '+';
                    } else {
                        content.style.maxHeight = content.scrollHeight + 'px';
                        icon.textContent = '−';
                    }
                });
            });

            // Initialize with the default chart
            createFinancialChart('revenue');

            const navLinks = document.querySelectorAll('.nav-link');
            const sections = document.querySelectorAll('section');
            window.addEventListener('scroll', () => {
                let current = '';
                sections.forEach(section => {
                    const sectionTop = section.offsetTop;
                    if (pageYOffset >= sectionTop - 80) {
                        current = section.getAttribute('id');
                    }
                });
                navLinks.forEach(link => {
                    link.classList.remove('nav-active');
                    if (link.getAttribute('href').includes(current)) {
                        link.classList.add('nav-active');
                    }
                });
            });

        });
    </script>

</body>
</html>

